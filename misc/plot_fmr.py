import matplotlib.pyplot as plt
import numpy as np


linestyle_str = [
    ('solid', 'solid'),  # Same as (0, ()) or '-'
    ('dotted', 'dotted'),  # Same as (0, (1, 1)) or '.'
    ('dashed', 'dashed'),  # Same as '--'
    ('dashdot', 'dashdot')]  # Same as '-.'

linestyle_tuple = [
    ('loosely dotted', (0, (1, 10))),
    ('dotted', (0, (1, 1))),
    ('densely dotted', (0, (1, 1))),

    ('loosely dashed', (0, (5, 10))),
    ('dashed', (0, (5, 5))),
    ('densely dashed', (0, (5, 1))),

    ('loosely dashdotted', (0, (3, 10, 1, 10))),
    ('dashdotted', (0, (3, 5, 1, 5))),
    ('densely dashdotted', (0, (3, 1, 1, 1))),

    ('dashdotdotted', (0, (3, 5, 1, 5, 1, 5))),
    ('loosely dashdotdotted', (0, (3, 10, 1, 10, 1, 10))),
    ('densely dashdotdotted', (0, (3, 1, 1, 1, 1, 1))),
    ('extra1', (0, (4, 1, 2, 1)))]

x = np.linspace(0.01, 0.2, 20)
threedmatch = np.array(
    [0.34988788, 1.735477, 6.3130245, 13.2243185, 20.68582, 28.49041, 34.01513, 40.062992, 45.687683, 52.00012,
     55.463696, 59.081406, 61.986275, 65.45967, 68.43626, 70.95725, 73.55156, 76.07139, 77.85846, 80.27285])
fpfh = np.array(
    [0.32518435, 3.0640497, 7.408897, 12.879427, 17.654156, 21.894594, 24.814766, 28.676664, 32.31617, 35.307827,
     38.895893, 41.363243, 44.120644, 47.001804, 49.11531, 52.33542, 55.02593, 56.853123, 59.70479, 61.781036])
spinimages = np.array(
    [0.2650882, 1.4736623, 3.4342945, 5.703008, 8.022694, 9.878324, 12.34205, 15.342176, 18.735947, 21.89705, 24.729364,
     28.054333, 31.125975, 33.943203, 36.965153, 40.642887, 43.33119, 46.57485, 49.260128, 52.152588])
shot = np.array(
    [0.47008017, 2.6745644, 5.1028447, 7.4799767, 9.238545, 11.927085, 16.089037, 18.879076, 22.094217, 24.974531,
     27.351418, 29.76674, 32.573856, 34.916573, 37.086315, 40.306644, 43.138355, 45.73636, 48.786892, 50.972153])
predator = np.array(
    [1.598646, 43.764183, 72.060312, 84.277961, 90.004648, 92.64463, 94.014723, 94.990602, 95.96624, 96.601441,
     96.806433, 97.099785, 97.35597, 97.35597, 97.380674, 97.380674, 97.611186, 97.90688, 98.178721, 98.238818])
fcgf = np.array(
    [4.135307, 50.302743, 76.513382, 87.786066, 92.033676, 93.6785, 94.900559, 96.311261, 96.912816, 97.353521,
     97.738293, 98.016699, 98.573519, 98.633615, 98.676423, 98.731733, 98.854555, 98.854555, 98.854555, 98.99945])
d3feat = np.array(
    [1.326839, 31.021349, 61.608349, 75.575873, 82.991841, 88.585381, 91.007284, 92.794678, 94.556689, 95.631483,
     96.580489, 96.768193, 96.8176, 96.920505, 97.085318, 97.128126, 97.695815, 97.816008, 97.985607, 97.985607])
dsn = np.array(
    [6.925493, 42.819659, 65.908609, 78.549499, 85.100889, 88.986995, 91.870439, 93.402519, 94.398583, 95.019629, 
    95.537113, 95.72003, 95.900319, 96.135917, 96.358351, 96.631008, 96.831329, 96.911342, 97.031535, 97.249845])
ppffold = np.array(
    [0.6783977, 7.9283724, 22.183943, 34.720436, 44.628433, 51.92579, 57.17631, 61.85746, 66.01428, 69.106926, 71.37115,
     73.30209, 74.196884, 75.28364, 76.539635, 77.94661, 79.70165, 80.93724, 81.7935, 82.764626])
cofinet = np.array(
    [ 0.       ,  6.1493262, 61.6405896, 84.110013 , 91.1524802, 94.0575963, 95.6404122, 96.636305 , 97.5596297, 98.0637688,
     98.5893126, 98.6494088, 98.7951213, 98.8980257, 99.018218 , 99.2184236, 99.2184236, 99.2184236, 99.2184236, 99.2184236])
ngenet = np.array([ 2.2959765, 52.5827081, 81.422583 , 91.0088155, 94.1351968, 96.3979454, 97.4483312, 97.4531176, 98.103794 , 98.2191998,
       98.6839846, 98.6123493, 98.8222816, 98.8897934, 99.1328072, 99.2029295, 99.2054049, 99.2523366, 99.4286554, 99.4352543])

fig = plt.figure(figsize=(12, 6), dpi=180)
ax1 = plt.subplot(121)
plt.xlabel("Inlier Distance Threshold (m)")
plt.ylabel("Feature Match Recall")
plt.plot(x, threedmatch, color='r', linewidth=3, linestyle='dotted')
plt.plot(x, fpfh, color='sienna', linewidth=3, linestyle='dashed')
plt.plot(x, spinimages, color='darkorange', linewidth=3, linestyle=linestyle_tuple[11][-1])
plt.plot(x, shot, color='darkgoldenrod', linewidth=3, linestyle=linestyle_tuple[8][-1])
plt.plot(x, predator, color='olive', linewidth=3, linestyle=linestyle_tuple[1][-1])
plt.plot(x, fcgf, color='lawngreen', linewidth=3, linestyle=linestyle_tuple[9][-1])
plt.plot(x, d3feat, color='lightcoral', linewidth=3, linestyle=linestyle_tuple[12][-1])
plt.plot(x, dsn, color='lightseagreen', linewidth=3, linestyle=linestyle_tuple[4][-1])
plt.plot(x, ppffold, color='royalblue', linewidth=3, linestyle=linestyle_tuple[5][-1])
plt.plot(x, cofinet, color='tomato', linewidth=3, linestyle='dashdot')
plt.plot(x, ngenet, color='magenta', linewidth=3, linestyle='solid')
plt.vlines(0.10, 0, 100, colors="gray", linestyles="dashed")  # vertical gray line
plt.xlim((0.01, 0.2))
plt.ylim((0, 100))

ax2 = plt.subplot(122)
plt.xlabel("Inlier Ratio Threshold")
threedmatch_ = np.array(
    [93.57423, 84.989296, 72.26616, 60.18662, 50.84514, 40.988052, 35.264496, 29.492676, 24.875406, 20.927317,
     18.053923, 14.7144, 12.210866, 10.735968, 9.550746, 8.107913, 7.4702764, 6.172435, 5.2574573, 4.3098807])
fpfh_ = np.array(
    [84.33316, 68.71096, 54.144688, 43.4266, 35.885315, 29.24774, 24.669365, 21.693983, 18.398415, 15.19658, 13.052581,
     10.593815, 9.197111, 7.121167, 6.0142927, 5.459413, 4.7025414, 3.7748396, 3.2582376, 2.9224794])
spinimages_ = np.array(
    [80.370415, 57.09011, 41.317715, 30.377916, 22.666761, 16.668486, 12.008004, 9.49888, 6.9450083, 5.2102103,
     4.6000204, 3.9652426, 3.6801224, 2.8298047, 2.4588833, 1.6771933, 1.4722013, 1.3379945, 1.1484778, 0.9681894])
shot_ = np.array(
    [74.7338, 55.754692, 41.421146, 31.38755, 23.82493, 18.377901, 14.077372, 11.229745, 9.498036, 7.2400875, 6.259093,
     5.4715004, 4.264607, 3.6964087, 3.070859, 2.418819, 2.0778346, 1.5370839, 1.5123804, 1.4522841])
predator_ = np.array(
    [98.859889, 97.909077, 97.500866, 97.125458, 96.601441, 95.734758, 94.609147, 94.146195, 93.172484, 92.713764,
     92.183001, 91.71345, 91.044471, 90.592342, 90.185631, 89.322503, 88.736845, 88.36471, 87.145778, 86.287232])
fcgf_ = np.array(
    [99.526474, 98.940171, 98.226632, 97.884006, 97.353521, 96.627542, 96.318829, 96.029037, 95.339938, 94.679256,
     93.99646, 93.517994, 92.618115, 92.43327, 92.128233, 91.267739, 90.514984, 90.144248, 89.87309, 89.340131])
d3feat_ = np.array(
    [98.452534, 97.660423, 97.020136, 96.768193, 95.631483, 94.327522, 92.314021, 90.721366, 89.756974, 88.743718,
     88.126642, 87.331697, 85.993739, 84.35534, 83.309026, 82.154434, 80.440724, 79.07386, 77.657352, 75.881642])
dsn_ = np.array(
    [99.053496, 97.806905, 97.138431, 96.063319, 95.019629, 93.43627, 92.676226, 91.676057, 89.926433, 88.093154, 86.428362,
     84.396438, 83.500374, 82.442937, 80.94519, 78.946443, 77.480061, 75.891795, 74.209464, 72.884469])
ppffold_ = np.array(
    [90.44259, 83.66921, 77.68714, 72.016045, 68.04171, 62.860317, 58.093655, 54.45246, 50.859642, 47.77691, 45.581078,
     42.854107, 39.8563, 36.73241, 33.889057, 32.212887, 30.558687, 28.446907, 27.44521, 25.17946])
cofinet_ = np.array(
     [99.5437618, 99.1583275, 98.674929 , 98.6321208, 98.0637688, 97.5596297, 97.1585488, 96.7813547, 95.9402301, 95.4706589,
      94.8710045, 94.4715556, 93.8568359, 93.4439539, 92.976464, 92.5283043, 91.9945671, 91.2894446, 90.9440743, 90.36093])
ngenet_ = np.array(
    [99.6064872, 99.2136372, 99.1454626, 98.6791982, 98.4062411, 98.1716052, 98.1335834, 97.4019246, 96.8714405, 96.3678561,
    96.2485274, 95.7483501, 95.5010978, 95.2512231, 95.0998699, 94.3443617, 94.1912335, 93.9154229, 93.2886161, 93.0445291])

plt.plot(x, threedmatch_, color='r', linewidth=3, label='3DMatch', linestyle='dotted')
plt.plot(x, fpfh_, color='sienna', linewidth=3, label='FPFH', linestyle='dashed')
plt.plot(x, spinimages_, color='darkorange', linewidth=3, label='SpinImages', linestyle=linestyle_tuple[11][-1])
plt.plot(x, shot_, color='darkgoldenrod', linewidth=3, label='SHOT', linestyle=linestyle_tuple[8][-1])
plt.plot(x, predator_, color='olive', linewidth=3, label='PREDATOR', linestyle=linestyle_tuple[1][-1])
plt.plot(x, fcgf_, color='lawngreen', linewidth=3, label='FCGF', linestyle=linestyle_tuple[2][-1])
plt.plot(x, d3feat_, color='lightcoral', linewidth=3, label='D3Feat', linestyle=linestyle_tuple[12][-1])
plt.plot(x, dsn_, color='lightseagreen', linewidth=3, label='3DSN', linestyle=linestyle_tuple[4][-1])
plt.plot(x, ppffold_, color='royalblue', linewidth=3, label='PPF-FoldNet', linestyle=linestyle_tuple[5][-1])
plt.plot(x, cofinet_, color='tomato', linewidth=3, label='CoFiNet', linestyle='dashdot')
plt.plot(x, ngenet_, color='magenta', linewidth=3, label='GCNet', linestyle='solid')
plt.vlines(0.05, 0, 100, colors="gray", linestyles="dashed")
plt.xlim((0.01, 0.2))
plt.ylim((0, 100))

plt.legend(bbox_to_anchor=(1.05, 0.28, 0.32, 0.5), loc=4,
           ncol=1, mode="expand", borderaxespad=0.)

fig.savefig('fig.pdf', dpi=1200, format='pdf', bbox_inches='tight')

plt.show()
